# Changelog - –î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–º–µ—Ä —á–µ—Ä–µ–∑ v4l2-ctl

## –í–µ—Ä—Å–∏—è —Å v4l2-ctl –¥–µ—Ç–µ–∫—Ç–æ—Ä–æ–º (2026-01-31)

### üìã –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

#### –ù–æ–≤—ã–π –º–æ–¥—É–ª—å –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: `utils/camera_detector.py`
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ v4l2-ctl**: –¢–æ—á–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–∞–º–µ—Ä —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏ –¥—Ä—É–≥–∏—Ö –Ω–µ-–≤–∏–¥–µ–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤
- **–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è**: –ü–æ–ª–Ω–∞—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ –∫–∞–∂–¥–æ–π –∫–∞–º–µ—Ä—ã —Å —Ñ–æ—Ä–º–∞—Ç–∞–º–∏ –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏
- **–†–µ–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**: –¢–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è—Ö –∏ FPS

### üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

#### –ù–æ–≤—ã–π –∫–ª–∞—Å—Å: `CameraDetector`
```python
class CameraDetector:
    def get_device_info(self, device_path: str) -> Dict
    def get_formats(self, device_path: str) -> List[Dict]
    def is_video_capture_device(self, device_path: str) -> bool
    def detect_cameras(self, max_devices: int = 10) -> List[Dict]
    def get_best_resolution_for_fps(self, formats: List[Dict], target_fps: int) -> Optional[Tuple[int, int]]
```

#### –§—É–Ω–∫—Ü–∏—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```python
def detect_cameras(max_devices: int = 10) -> List[Dict]
```

### üéØ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

#### –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–º–∞–Ω–¥—ã v4l2-ctl
- **–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ**: `v4l2-ctl -d /dev/videoN --info`
- **–°–ø–∏—Å–æ–∫ —Ñ–æ—Ä–º–∞—Ç–æ–≤**: `v4l2-ctl -d /dev/videoN --list-formats-ext`
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π**: –ê–Ω–∞–ª–∏–∑ Capabilities –∏ Device Caps

#### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤
```python
# –ò—Å–∫–ª—é—á–∞–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
if 'metadata capture' in capabilities and 'video capture' not in capabilities:
    return False

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
if 'Video Capture' in capabilities or 'Video Capture' in device_caps:
    return True
```

#### –ü–∞—Ä—Å–∏–Ω–≥ —Ñ–æ—Ä–º–∞—Ç–æ–≤
- **–§–æ—Ä–º–∞—Ç—ã**: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ (YUYV, MJPG –∏ –¥—Ä.)
- **–†–∞–∑—Ä–µ—à–µ–Ω–∏—è**: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞
- **FPS**: –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ—á–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π FPS –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è

### üìã –ß—Ç–æ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

#### –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
```
======================================================================
üîç –†–ï–ó–£–õ–¨–¢–ê–¢–´ –î–ï–¢–ï–ö–¢–ò–†–û–í–ê–ù–ò–Ø –ö–ê–ú–ï–†
======================================================================
```

#### –î–ª—è –∫–∞–∂–¥–æ–π –Ω–∞–π–¥–µ–Ω–Ω–æ–π –∫–∞–º–µ—Ä—ã
```
üìπ –ö–ê–ú–ï–†–ê 1: /dev/video0
   üè∑Ô∏è  –¢–∏–ø: UVC Camera (046d:0825)
   üöÄ –î—Ä–∞–π–≤–µ—Ä: uvcvideo
   üöå –®–∏–Ω–∞: usb-0000:02:00.0-2
   üìã –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è: 640x480, 800x600, 1280x720
   üìä –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ FPS: 5, 10, 15, 25, 30
   üì¥ –§–æ—Ä–º–∞—Ç—ã:
      - YUYV (YUYV 4:2:2): 640x480, 800x600, 1280x720
      - MJPG (Motion-JPEG, compressed): 640x480, 800x600, 1280x720
```

#### –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
```
/dev/video3 - –Ω–µ –≤–∏–¥–µ–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ (–º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏–ª–∏ –¥—Ä—É–≥–æ–µ)
```

### üîç –ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

#### –í–∏–¥–µ–æ–∫–∞–º–µ—Ä–∞
```
Driver Info:
        Driver name      : uvcvideo
        Card type        : UVC Camera (046d:0825)
        Bus info         : usb-0000:02:00.0-2
        Capabilities     : 0x84200001
                Video Capture
                Streaming
                Extended Pix Format
                Device Capabilities
```

#### –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
```
Driver Info:
        Driver name      : uvcvideo
        Card type        : UVC Camera (046d:0825)
        Bus info         : usb-0000:02:00.0-2
        Capabilities     : 0x84a00001
                Video Capture
                Metadata Capture
                Streaming
                Extended Pix Format
                Device Capabilities
        Device Caps      : 0x04a00000
                Metadata Capture
                Streaming
                Extended Pix Format
```

### üöÄ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã

1. **–¢–æ—á–Ω–æ—Å—Ç—å**: –†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
2. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ-–≤–∏–¥–µ–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤
3. **–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç—å**: –ü–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–æ—Ä–º–∞—Ç–∞—Ö –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è—Ö
4. **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç
5. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –ë—ã—Å—Ç—Ä–æ–µ –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ –æ—Ç–∫—Ä—ã—Ç–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤

### üìÅ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º—É

#### –ó–∞–º–µ–Ω–∞ —Å—Ç–∞—Ä–æ–≥–æ –º–µ—Ç–æ–¥–∞
```python
# –ë—ã–ª–æ: OpenCV —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
available_cameras = logger.scan_available_cameras()

# –°—Ç–∞–ª–æ: v4l2-ctl –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
available_cameras = logger.scan_available_cameras()
```

#### –í–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ
```python
camera_info = {
    'device_path': '/dev/video0',
    'device_id': 0,
    'card_type': 'UVC Camera (046d:0825)',
    'driver': 'uvcvideo',
    'bus_info': 'usb-0000:02:00.0-2',
    'capabilities': '0x84200001',
    'formats': [
        {
            'index': 0,
            'name': 'YUYV',
            'description': 'YUYV 4:2:2',
            'sizes': [
                {'width': 640, 'height': 480, 'fps': [5, 10, 15, 25, 30]},
                {'width': 1280, 'height': 720, 'fps': [5, 10, 15, 25, 30]}
            ]
        }
    ],
    'supported_resolutions': ['640x480', '1280x720'],
    'supported_fps': [5, 10, 15, 25, 30]
}
```

### üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ v4l2-ctl
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —É—Ç–∏–ª–∏—Ç—ã
sudo apt install v4l-utils

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã
v4l2-ctl --list-devices
```

#### –†—É—á–Ω–æ–µ –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–º–µ—Ä
```python
from utils.camera_detector import detect_cameras

cameras = detect_cameras(max_devices=10)
for cam in cameras:
    print(f"–ö–∞–º–µ—Ä–∞: {cam['device_path']} - {cam['card_type']}")
    print(f"–†–∞–∑—Ä–µ—à–µ–Ω–∏—è: {cam['supported_resolutions']}")
    print(f"FPS: {cam['supported_fps']}")
```

### üìù –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### –ó–∞–ø—É—Å–∫ —Å –Ω–æ–≤—ã–º –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
```bash
python 04_flask_webcam_stream.py
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç v4l2-ctl –¥–ª—è –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–∞–º–µ—Ä
```

#### –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤
```bash
# –ü–æ–∏—Å–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–∞–º–µ—Ä–∞—Ö
grep "üîç –†–ï–ó–£–õ–¨–¢–ê–¢–´ –î–ï–¢–ï–ö–¢–ò–†–û–í–ê–ù–ò–Ø –ö–ê–ú–ï–†" 002_logs/flask_stream_*.log

# –ü–æ–∏—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–∞–º–µ—Ä—ã
grep "üìπ –ö–ê–ú–ï–†–ê" 002_logs/flask_stream_*.log

# –ê–Ω–∞–ª–∏–∑ —Ñ–æ—Ä–º–∞—Ç–æ–≤
grep "üìπ –ö–ê–ú–ï–†–ê" -A 10 002_logs/flask_stream_*.log
```

–ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–∞–º–µ—Ä —á–µ—Ä–µ–∑ v4l2-ctl –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ç–æ—á–Ω—É—é –∏ –Ω–∞–¥–µ–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤–∏–¥–µ–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö!
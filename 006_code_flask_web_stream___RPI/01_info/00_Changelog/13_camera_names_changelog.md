# Changelog - –ù–∞–∑–≤–∞–Ω–∏—è –∫–∞–º–µ—Ä –∏–∑ lsusb

## –í–µ—Ä—Å–∏—è —Å –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ –∫–∞–º–µ—Ä (2026-01-31)

### üìù –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

#### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏–π –∫–∞–º–µ—Ä –≤ –ª–æ–≥–∏
- **USB —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ USB –∫–∞–º–µ—Ä–∞—Ö —á–µ—Ä–µ–∑ `lsusb`
- **–°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ**: –°–≤—è–∑—å –≤–∏–¥–µ–æ–∫–∞–º–µ—Ä —Å USB —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ –ø–æ ID –∏ –¥—Ä–∞–π–≤–µ—Ä–∞–º
- **–ù–∞–∑–≤–∞–Ω–∏—è –≤ –ª–æ–≥–∞—Ö**: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏–π –∫–∞–º–µ—Ä –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

#### –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è: `_get_usb_devices()`
```python
def _get_usb_devices(self) -> Dict[str, Dict]:
    """–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ USB —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö"""
    usb_devices = {}
    try:
        result = subprocess.run(['lsusb'], capture_output=True, text=True, timeout=5)
        if result.returncode == 0:
            for line in result.stdout.split('\n'):
                if 'ID' in line and 'Camera' in line:
                    # –ü–∞—Ä—Å–∏–º —Å—Ç—Ä–æ–∫—É –≤–∏–¥–∞: Bus 001 Device 012: ID 0c45:6340 Microdia Camera
                    match = re.search(r'ID\s+([0-9a-f]{4}):([0-9a-f]{4})\s+(.+)', line)
                    if match:
                        vendor_id, product_id, description = match.groups()
                        usb_id = f"{vendor_id}:{product_id}"
                        usb_devices[usb_id] = {
                            'vendor_id': vendor_id,
                            'product_id': product_id,
                            'description': description.strip()
                        }
    except Exception as e:
        self.logger.debug(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ USB —É—Å—Ç—Ä–æ–π—Å—Ç–≤: {e}")
    
    return usb_devices
```

#### –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è: `_get_camera_name()`
```python
def _get_camera_name(self, device_path: str) -> str:
    """–ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–∞–º–µ—Ä—ã –ø–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É"""
    try:
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
        result = subprocess.run(
            ['v4l2-ctl', '-d', device_path, '--info'],
            capture_output=True,
            text=True,
            timeout=5
        )
        
        if result.returncode == 0:
            # –ò—â–µ–º —Å—Ç—Ä–æ–∫—É —Å driver
            for line in result.stdout.split('\n'):
                if 'Driver name' in line:
                    driver = line.split(':')[1].strip()
                    
                    # –°–æ–ø–æ—Å—Ç–∞–≤–ª—è–µ–º –¥—Ä–∞–π–≤–µ—Ä —Å USB —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
                    for usb_id, usb_info in self.usb_devices.items():
                        if driver.lower() in usb_info['description'].lower():
                            return usb_info['description']
        
        return "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–∞–º–µ—Ä–∞"
    except Exception as e:
        self.logger.debug(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–∞–º–µ—Ä—ã {device_path}: {e}")
        return "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–∞–º–µ—Ä–∞"
```

### üéØ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–∞–∑–≤–∞–Ω–∏–π –∫–∞–º–µ—Ä:

#### –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è:
1. **–ü–æ–ª—É—á–µ–Ω–∏–µ USB —É—Å—Ç—Ä–æ–π—Å—Ç–≤**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ USB —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —á–µ—Ä–µ–∑ `lsusb`
2. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–∞–º–µ—Ä**: –í—ã–±–æ—Ä —Ç–æ–ª—å–∫–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —Å –ø–æ–º–µ—Ç–∫–æ–π "Camera"
3. **–°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø–æ –¥—Ä–∞–π–≤–µ—Ä—É**: –°–≤—è–∑—å –≤–∏–¥–µ–æ–∫–∞–º–µ—Ä—ã —Å USB —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ–º –ø–æ –∏–º–µ–Ω–∏ –¥—Ä–∞–π–≤–µ—Ä–∞
4. **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –ª–æ–≥–∞—Ö**: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–∞–º–µ—Ä—ã –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

#### –ü—Ä–∏–º–µ—Ä—ã —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è:

**–ò–∑ lsusb:**
```
Bus 001 Device 012: ID 0c45:6340 Microdia Camera
Bus 003 Device 003: ID 046d:0825 Logitech, Inc. Webcam C270
```

**–í –ª–æ–≥–∞—Ö:**
```
üìπ –ö–ê–ú–ï–†–ê 1: /dev/video0 (Microdia Camera)
üìπ –ö–ê–ú–ï–†–ê 2: /dev/video2 (Logitech, Inc. Webcam C270)
```

### üìã –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –≤ –ª–æ–≥–∞—Ö

#### –ë—ã–ª–æ:
```
üìπ –ö–ê–ú–ï–†–ê 1: /dev/video0
   üì¥ –§–æ—Ä–º–∞—Ç—ã: YUYV, MJPG
   üìã –†–∞–∑—Ä–µ—à–µ–Ω–∏—è:
      ‚Ä¢ 640x360
      ‚Ä¢ 640x480
      ‚Ä¢ 1280x720
```

#### –°—Ç–∞–ª–æ:
```
üìπ –ö–ê–ú–ï–†–ê 1: /dev/video0 (Microdia Camera)
   üì¥ –§–æ—Ä–º–∞—Ç—ã: YUYV, MJPG
   üìã –†–∞–∑—Ä–µ—à–µ–Ω–∏—è:
      ‚Ä¢ 640x360
      ‚Ä¢ 640x480
      ‚Ä¢ 1280x720
```

### üöÄ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–∞–∑–≤–∞–Ω–∏–π –∫–∞–º–µ—Ä:

1. **–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: –õ–µ–≥–∫–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫–∞–∫–∞—è –∏–º–µ–Ω–Ω–æ –∫–∞–º–µ—Ä–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∞
2. **–£–¥–æ–±—Å—Ç–≤–æ**: –ù–µ –Ω—É–∂–Ω–æ –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å –Ω–æ–º–µ—Ä–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (/dev/video0, /dev/video2)
3. **–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –≤–∏–¥**: –ë–æ–ª–µ–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –ª–æ–≥–∏
4. **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**: –£–ø—Ä–æ—â–µ–Ω–∏–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º —Å –∫–∞–º–µ—Ä–∞–º–∏

### üìÅ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

#### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞
```bash
cd 004_code_flask_web_stream
python utils/camera_checker.py
```

#### –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
```
üîç –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É–ª—É—á—à–µ–Ω–Ω–æ–≥–æ –¥–µ—Ç–µ–∫—Ç–æ—Ä–∞ –∫–∞–º–µ—Ä...
==================================================
üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø:
==================================================
‚úÖ –ù–∞–π–¥–µ–Ω–æ –≤–∏–¥–µ–æ–∫–∞–º–µ—Ä: 2

üìπ –ö–ê–ú–ï–†–ê 1: /dev/video0 (Microdia Camera)
   –§–æ—Ä–º–∞—Ç—ã: YUYV, MJPG
   –†–∞–∑—Ä–µ—à–µ–Ω–∏—è: 640x480, 1280x720, 640x360

üìπ –ö–ê–ú–ï–†–ê 2: /dev/video2 (Logitech, Inc. Webcam C270)
   –§–æ—Ä–º–∞—Ç—ã: YUYV, MJPG
   –†–∞–∑—Ä–µ—à–µ–Ω–∏—è: 640x480, 160x120, 176x144

==================================================
‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ
```

### üìù –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### –ó–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞
```bash
python 04_flask_webcam_stream.py
# –¢–µ–ø–µ—Ä—å –≤ –ª–æ–≥–∞—Ö –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –Ω–∞–∑–≤–∞–Ω–∏—è –∫–∞–º–µ—Ä
```

#### –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤
```bash
# –ü–æ–∏—Å–∫ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –∫–∞–º–µ—Ä —Å –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏
grep "üìπ –ö–ê–ú–ï–†–ê" 002_logs/flask_stream_*.log
```

### üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ –≤–µ—Ä—Å–∏—è–º–∏

| –í–µ—Ä—Å–∏—è | –ù–∞–∑–≤–∞–Ω–∏—è –∫–∞–º–µ—Ä | –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ |
|--------|---------------|-------------|
| 1.0 | –ù–µ—Ç | /dev/video0 |
| 2.0 | –î–∞ | /dev/video0 (Microdia Camera) |

–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏–π –∫–∞–º–µ—Ä –∏–∑ lsusb –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ª—É—á—à—É—é –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –∏ —É–¥–æ–±—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã!